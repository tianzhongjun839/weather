<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°æ¹¾å¤©æ°”å¿«è®¯</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
            margin: 0;
            padding: 20px;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        .content {
            padding: 30px;
        }
        .weather-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        .weather-section h3 {
            margin: 0 0 15px 0;
            color: #2c3e50;
            font-size: 1.3em;
        }
        .weather-section p {
            margin: 8px 0;
            white-space: pre-line;
        }
        .alert-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #fff3cd;
            border-radius: 8px;
            border-left: 4px solid #ffc107;
        }
        .alert-section h3 {
            margin: 0 0 15px 0;
            color: #856404;
            font-size: 1.3em;
        }
        .alert-section p {
            margin: 8px 0;
            white-space: pre-line;
        }
        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            color: #6c757d;
            border-top: 1px solid #dee2e6;
        }
        .rss-link {
            display: inline-block;
            background: #ff6b35;
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 6px;
            margin: 10px;
            transition: background 0.3s;
        }
        .rss-link:hover {
            background: #e55a2b;
        }
        .update-time {
            font-size: 0.9em;
            color: #6c757d;
            margin-top: 10px;
        }
        .loading {
            text-align: center;
            padding: 40px;
            color: #6c757d;
        }
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 6px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒ¤ï¸ å°æ¹¾å¤©æ°”å¿«è®¯</h1>
            <p>å°åŒ—ã€æ–°åŒ—ã€æ¡ƒå›­å®æ—¶å¤©æ°”ä¸é¢„è­¦ä¿¡æ¯</p>
            <div class="update-time" id="updateTime"></div>
        </div>
        
        <div class="content">
            <div id="loading" class="loading">
                <p>æ­£åœ¨åŠ è½½å¤©æ°”ä¿¡æ¯...</p>
            </div>
            
            <div id="error" class="error" style="display: none;">
                <p>åŠ è½½å¤©æ°”ä¿¡æ¯å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</p>
            </div>
            
            <div id="weatherContent" style="display: none;">
                <!-- å¤©æ°”å†…å®¹å°†åœ¨è¿™é‡ŒåŠ¨æ€åŠ è½½ -->
            </div>
        </div>
        
        <div class="footer">
            <p>æ•°æ®æ¥æºï¼šä¸­å¤®æ°”è±¡ç½² | æ›´æ–°æ—¶é—´ï¼š<span id="lastUpdate"></span></p>
            <a href="weather.xml" class="rss-link">ğŸ“¡ RSSè®¢é˜…</a>
            <a href="https://github.com/eliu-lotso/qweather" class="rss-link">ğŸ“‚ é¡¹ç›®æºç </a>
        </div>
    </div>

    <script>
        async function loadWeatherData() {
            try {
                const response = await fetch('weather.xml');
                const xmlText = await response.text();
                
                // è§£æXML
                const parser = new DOMParser();
                const xmlDoc = parser.parseFromString(xmlText, 'text/xml');
                
                // è·å–æè¿°å†…å®¹
                const description = xmlDoc.querySelector('description').textContent;
                
                // è§£æå†…å®¹å¹¶æ ¼å¼åŒ–æ˜¾ç¤º
                const content = parseWeatherContent(description);
                document.getElementById('weatherContent').innerHTML = content;
                document.getElementById('weatherContent').style.display = 'block';
                
                // æ›´æ–°æ—¶é—´
                const pubDate = xmlDoc.querySelector('pubDate').textContent;
                document.getElementById('lastUpdate').textContent = new Date(pubDate).toLocaleString('zh-TW');
                document.getElementById('updateTime').textContent = `æœ€åæ›´æ–°ï¼š${new Date(pubDate).toLocaleString('zh-TW')}`;
                
                document.getElementById('loading').style.display = 'none';
                
            } catch (error) {
                console.error('åŠ è½½å¤©æ°”æ•°æ®å¤±è´¥:', error);
                document.getElementById('error').style.display = 'block';
                document.getElementById('loading').style.display = 'none';
            }
        }
        
        function parseWeatherContent(description) {
            const lines = description.split('\n');
            let html = '';
            let currentSection = '';
            
            for (let line of lines) {
                line = line.trim();
                if (!line) continue;
                
                if (line.startsWith('ã€') && line.includes('ã€‘ä»Šæ—¥å¤©æ°”ï¼š')) {
                    // åŸå¸‚å¤©æ°”ä¿¡æ¯
                    if (currentSection !== 'weather') {
                        if (currentSection) html += '</div>';
                        html += '<div class="weather-section">';
                        html += '<h3>ğŸŒ¤ï¸ ä»Šæ—¥å¤©æ°”</h3>';
                        currentSection = 'weather';
                    }
                    html += `<p><strong>${line}</strong></p>`;
                } else if (line.startsWith('ğŸŒ¤ï¸')) {
                    // æœªæ¥å¤©æ°”
                    if (currentSection !== 'future') {
                        if (currentSection) html += '</div>';
                        html += '<div class="weather-section">';
                        html += '<h3>ğŸ“… æœªæ¥å¤©æ°”</h3>';
                        currentSection = 'future';
                    }
                    html += `<p>${line}</p>`;
                } else if (line.startsWith('âš ï¸')) {
                    // é¢„è­¦ä¿¡æ¯
                    if (currentSection !== 'alert') {
                        if (currentSection) html += '</div>';
                        html += '<div class="alert-section">';
                        html += '<h3>âš ï¸ å¤©æ°”é¢„è­¦</h3>';
                        currentSection = 'alert';
                    }
                    html += `<p><strong>${line}</strong></p>`;
                } else if (line.startsWith('- ')) {
                    // é¢„è­¦è¯¦æƒ…
                    html += `<p>${line}</p>`;
                } else if (line.startsWith('æ€»ä½“ï¼š')) {
                    // æ€»ä½“æ€»ç»“
                    html += `<p><strong>ğŸ“‹ æ€»ä½“ï¼š</strong>${line.substring(3)}</p>`;
                } else {
                    // å…¶ä»–å†…å®¹
                    html += `<p>${line}</p>`;
                }
            }
            
            if (currentSection) {
                html += '</div>';
            }
            
            return html;
        }
        
        // é¡µé¢åŠ è½½æ—¶è·å–å¤©æ°”æ•°æ®
        document.addEventListener('DOMContentLoaded', loadWeatherData);
        
        // æ¯30åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°ä¸€æ¬¡
        setInterval(loadWeatherData, 30 * 60 * 1000);
    </script>
</body>
</html> 